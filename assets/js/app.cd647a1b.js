(function(e){function t(t){for(var c,i,r=t[0],l=t[1],s=t[2],p=0,d=[];p<r.length;p++)i=r[p],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&d.push(a[i][0]),a[i]=0;for(c in l)Object.prototype.hasOwnProperty.call(l,c)&&(e[c]=l[c]);u&&u(t);while(d.length)d.shift()();return o.push.apply(o,s||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],c=!0,r=1;r<n.length;r++){var l=n[r];0!==a[l]&&(c=!1)}c&&(o.splice(t--,1),e=i(i.s=n[0]))}return e}var c={},a={app:0},o=[];function i(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=c,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)i.d(n,c,function(t){return e[t]}.bind(null,c));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var s=0;s<r.length;s++)t(r[s]);var u=l;o.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"3eef":function(e,t,n){"use strict";n("f206")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23");function a(e,t,n,a,o,i){var r=Object(c["j"])("HelloWorld");return Object(c["g"])(),Object(c["b"])(r,{msg:"Welcome to Your Vue.js App"})}var o=function(e){return Object(c["i"])("data-v-a73e4cca"),e=e(),Object(c["h"])(),e},i={class:"hello"},r=o((function(){return Object(c["e"])("h1",null,"Generic Pay Connector - Agent Assist",-1)})),l={key:0},s={key:3},u={key:0,class:"incoming-call"},p=o((function(){return Object(c["e"])("p",null,"Incoming Call",-1)})),d={key:2},m=o((function(){return Object(c["e"])("h2",null,"Pay Session",-1)})),b={for:"payment-amount"},y=Object(c["f"])("Payment Amount "),f=["disabled"],j=["disabled"],h={key:0},O=o((function(){return Object(c["e"])("h3",null,"Payment Details",-1)})),C={class:"payment-details"},v=Object(c["f"])("Card Number: "),g=["value"],S=Object(c["f"])("Expiration Date: "),D=["value"],P=Object(c["f"])("Postal Code: "),k=["value"],w=Object(c["f"])("Security Code: "),x=["value"],T={key:0},$={class:"payment-prompts"},A={key:1},N={key:2};function R(e,t,n,a,o,R){return Object(c["g"])(),Object(c["d"])("div",i,[r,o.phoneNumber?(Object(c["g"])(),Object(c["d"])("h2",l,"Call "+Object(c["k"])(o.phoneNumber),1)):Object(c["c"])("",!0),o.deviceCreated?Object(c["c"])("",!0):(Object(c["g"])(),Object(c["d"])("button",{key:1,class:"startup",onClick:t[0]||(t[0]=function(){return R.startDevice&&R.startDevice.apply(R,arguments)})},"Start up the device")),o.deviceCreated?(Object(c["g"])(),Object(c["d"])("button",{key:2,onClick:t[1]||(t[1]=function(){return R.stopDevice&&R.stopDevice.apply(R,arguments)})},"Stop the device")):Object(c["c"])("",!0),o.deviceCreated?(Object(c["g"])(),Object(c["d"])("div",s,[o.incomingCall?(Object(c["g"])(),Object(c["d"])("div",u,[p,Object(c["e"])("button",{id:"button-accept-incoming",onClick:t[2]||(t[2]=function(){return R.acceptCall&&R.acceptCall.apply(R,arguments)})},"Accept"),Object(c["e"])("button",{id:"button-reject-incoming",onClick:t[3]||(t[3]=function(){return R.rejectCall&&R.rejectCall.apply(R,arguments)})},"Reject")])):Object(c["c"])("",!0),o.activeCall?(Object(c["g"])(),Object(c["d"])("button",{key:1,onClick:t[4]||(t[4]=function(){return R.hangupCall&&R.hangupCall.apply(R,arguments)})},"Hangup")):Object(c["c"])("",!0),o.activeCall?(Object(c["g"])(),Object(c["d"])("section",d,[m,Object(c["e"])("form",null,[Object(c["e"])("label",b,[y,Object(c["m"])(Object(c["e"])("input",{id:"payment-amount",disabled:null!==o.paymentSid,"onUpdate:modelValue":t[5]||(t[5]=function(e){return o.paymentDetails.paymentAmount=e})},null,8,f),[[c["l"],o.paymentDetails.paymentAmount]])]),Object(c["e"])("button",{onClick:t[6]||(t[6]=Object(c["n"])((function(){return R.startPaymentSession&&R.startPaymentSession.apply(R,arguments)}),["prevent"])),disabled:null!==o.paymentSid},"Start Payment Session",8,j)]),null!==o.paymentSid?(Object(c["g"])(),Object(c["d"])("div",h,[O,Object(c["e"])("ul",C,[Object(c["e"])("li",null,[v,Object(c["e"])("input",{value:o.paymentDetails.cardNumber,disabled:""},null,8,g)]),Object(c["e"])("li",null,[S,Object(c["e"])("input",{value:o.paymentDetails.expirationDate,disabled:""},null,8,D)]),Object(c["e"])("li",null,[P,Object(c["e"])("input",{value:o.paymentDetails.postalCode,disabled:""},null,8,k)]),Object(c["e"])("li",null,[w,Object(c["e"])("input",{value:o.paymentDetails.securityCode,disabled:""},null,8,x)])]),o.currentCaptureStep?(Object(c["g"])(),Object(c["d"])("h3",T,"Currently capturing: "+Object(c["k"])(o.currentCaptureStep),1)):Object(c["c"])("",!0),Object(c["e"])("ul",$,[Object(c["e"])("li",null,[Object(c["e"])("button",{onClick:t[7]||(t[7]=function(e){return R.updatePaymentSession("payment-card-number")})},"Capture Payment Card Number")]),Object(c["e"])("li",null,[Object(c["e"])("button",{onClick:t[8]||(t[8]=function(e){return R.updatePaymentSession("expiration-date")})},"Capture Expiration Date")]),Object(c["e"])("li",null,[Object(c["e"])("button",{onClick:t[9]||(t[9]=function(e){return R.updatePaymentSession("postal-code")})},"Capture Postal Code")]),Object(c["e"])("li",null,[Object(c["e"])("button",{onClick:t[10]||(t[10]=function(e){return R.updatePaymentSession("security-code")})},"Capture Security Code")])]),Object(c["e"])("button",{onClick:t[11]||(t[11]=Object(c["n"])((function(){return R.endPaymentSession&&R.endPaymentSession.apply(R,arguments)}),["prevent"]))},"Complete Payment Session")])):Object(c["c"])("",!0),o.paymentDetails.errorType?(Object(c["g"])(),Object(c["d"])("p",A,Object(c["k"])(o.paymentDetails.errorType),1)):Object(c["c"])("",!0),o.successMessage?(Object(c["g"])(),Object(c["d"])("p",N,Object(c["k"])(o.successMessage),1)):Object(c["c"])("",!0)])):Object(c["c"])("",!0)])):Object(c["c"])("",!0)])}var M=n("1da1"),_=(n("96cf"),n("d3b7"),n("a630"),n("3ca3"),n("ddb0"),n("e9c4"),n("df46")),H=n("64e1"),I=n("11c1"),J={name:"HelloWorld",props:{msg:String},data:function(){return{paymentDetails:{paymentAmount:"",cardNumber:"",expirationDate:"",postalCode:"",securityCode:"",errorType:"",result:"",paymentConfirmationCode:""},paymentSessionStatus:"",deviceCreated:!1,activeCall:!1,incomingCall:!1,syncClient:null,paymentSid:null,successMessage:null,domain:null,phoneNumber:null,currentCaptureStep:null}},methods:{startDevice:function(){var e=this;return Object(M["a"])(regeneratorRuntime.mark((function t(){var n,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(e.domain,"/token"));case 3:return n=t.sent,t.next=6,n.json();case 6:c=t.sent,e.$options.device=new _["Device"](c.accessToken),e.phoneNumber=c.phoneNumber,e.deviceCreated=!0,e.$options.device.on("registered",(function(){console.log("Device ready to receive calls.")})),e.$options.device.on("incoming",e.handleIncomingCall),e.$options.device.on("error",(function(e){console.log("Device error: "+e.message)})),console.log("Registering to receive incoming calls."),e.$options.device.register(),e.getSyncClient(c),t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](0),console.error("error during fetch",t.t0.message);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})))()},handleIncomingCall:function(e){this.incomingCall=!0,this.$options.activeCall=e},stopDevice:function(){this.incomingCall=!1,this.activeCall=!1,this.$options.device.destroy(),this.deviceCreated=!1},log:function(e){var t=this;this.logMessages.push(e),this.$nextTick((function(){t.updateLogScrollHeight()}))},updateLogScrollHeight:function(){var e=this.$el.querySelector("#log");e.scrollTop=e.scrollHeight},hangupCall:function(){this.$options.activeCall.disconnect(),this.incomingCall=!1,this.activeCall=!1},rejectCall:function(){this.incomingCall=!1,this.$options.activeCall.reject(),this.activeCall=!1},acceptCall:function(){this.incomingCall=!1,this.activeCall=!0,this.$options.activeCall.accept(),this.$options.activeCall.on("cancel",this.handleDisconnectedCall),this.$options.activeCall.on("disconnect",this.handleDisconnectedCall),this.createSyncDocument()},handleDisconnectedCall:function(){this.activeCall=!1},getParentCallSid:function(){return Array.from(this.$options.activeCall.customParameters.values())[0]},startPaymentSession:function(){var e=this;return Object(M["a"])(regeneratorRuntime.mark((function t(){var n,c,a,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="".concat(e.domain,"/startPaySession"),c=e,a=e.getParentCallSid(),t.next=5,fetch(n,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentAmount:c.paymentDetails.paymentAmount,callSid:a,syncDocumentSid:c.syncDocumentSid})});case 5:return o=t.sent,t.next=8,o.json();case 8:i=t.sent,e.paymentSid=i.paymentSid,console.log("Pay Session Started. SID: ",i.paymentSid);case 11:case"end":return t.stop()}}),t)})))()},updatePaymentSession:function(e){var t=this;return Object(M["a"])(regeneratorRuntime.mark((function n(){var c,a,o,i,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.currentCaptureStep=e,c="".concat(t.domain,"/updatePaySession"),a=t,o=t.getParentCallSid(),n.next=6,fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentStep:e,paymentSid:a.paymentSid,callSid:o,syncDocumentSid:a.syncDocumentSid})});case 6:return i=n.sent,n.next=9,i.json();case 9:r=n.sent,console.log("update response: ",r);case 11:case"end":return n.stop()}}),n)})))()},endPaymentSession:function(){var e=this;return Object(M["a"])(regeneratorRuntime.mark((function t(){var n,c,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="".concat(e.domain,"/completePaySession"),c=e,a=e.getParentCallSid(),t.next=5,fetch(n,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentSid:c.paymentSid,callSid:a,syncDocumentSid:c.syncDocumentSid})});case 5:e.currentCaptureStep=null;case 6:case"end":return t.stop()}}),t)})))()},getSyncClient:function(e){this.syncClient=new H["SyncClient"](e.accessToken,{logLevel:"info"}),this.syncClient.on("connectionStateChanged",(function(e){"connected"===e&&console.log("Sync Client Connected")}))},clearPaymentDetails:function(){this.paymentDetails={paymentAmount:"",cardNumber:"",expirationDate:"",postalCode:"",securityCode:"",errorType:"",result:"",paymentConfirmationCode:""}},createSyncDocument:function(){var e=this;this.syncDocumentSid=Object(I["v4"])(),this.syncClient.document(this.syncDocumentSid).then((function(t){t.on("updated",(function(t){console.log("Sync Document Updated",t),t.isLocal||(console.log("Setting state with: ",t.data),e.paymentDetails=t.data,"success"===e.paymentDetails.result&&(e.paymentSid=null,e.successMessage="Payment successful. Confirmation code: ".concat(e.paymentDetails.paymentConfirmationCode),e.clearPaymentDetails()))}))}))}},mounted:function(){this.domain=window.location.origin}},L=(n("90e5"),n("6b0d")),W=n.n(L);const E=W()(J,[["render",R],["__scopeId","data-v-a73e4cca"]]);var U=E,V={name:"App",components:{HelloWorld:U}};n("3eef");const q=W()(V,[["render",a]]);var G=q;Object(c["a"])(G).mount("#app")},"583a":function(e,t,n){},"90e5":function(e,t,n){"use strict";n("583a")},f206:function(e,t,n){}});
//# sourceMappingURL=app.cd647a1b.js.map